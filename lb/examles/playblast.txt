var PATH = "c:/sthpw/maya/playblast.jpg";
spt.app_busy.show("Generating Playblast", "")

var server = TacticServerStub.get()
var applet = spt.Applet.get()

// Build  the MEL command for the playblast
var mel = []
mel.push('playblast')
mel.push('-fo')
mel.push('-fmt "image"')
mel.push('-cf "'+ PATH +'"')
mel.push('-fr 1')
mel.push('-orn 0')
mel.push('-width 720')
mel.push('-height 405')
mel = mel.join(" ")

// Build the MEL command to set the render globals to JPG (#8)
var drg = 'setAttr "defaultRenderGlobals.imageFormat" 8;'

// Run the render Globals command
applet.command_port("localhost", "4444", drg, wait_for="true")

// Run the playblast command
applet.command_port("localhost", "4444", mel, wait_for="true")

// Checkin the results as an icon
server.simple_checkin(bvr.search_key, "icon", PATH, {'create_icon':'True'})

// Update the table
var update_event = "update|" + bvr.search_key;
spt.named_events.fire_event(update_event, {});

// Alert Complete.
spt.info("Complete")
spt.app_busy.hide();


import maya.cmds as cmds
filename = 'c:/playblast.jpg'
cmds.playblast(forceOverwrite=True, format='image', completeFilename=filename, showOrnaments=False, widthHeight=[0,0], sequenceTime=True, compression='jpg', offScreen=True, viewer=True, percent=100)
